---
const base = Astro.site?.pathname ?? "/";
const href = (path = "") => `${base}${path}`.replace(/\/+/g, "/");
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width" />

    <title>My Learning Tracker</title>

    <style is:global>
      :root {
        --bg: #0b0f19;
        --surface: #111827;
        --surface-elevated: #1f2937;

        --text: #e5e7eb;
        --muted-text: #9ca3af;

        --accent: #22d3ee;
        --accent-soft: rgba(34, 211, 238, 0.12);

        --border: #1f2937;
        --sidebar-width: 220px;
      }

      html {
        transition:
          background-color 0.4s ease,
          color 0.4s ease;
      }

      html.light {
        --bg: #f9fafb;
        --surface: #ffffff;
        --surface-elevated: #f3f4f6;

        --text: #0b1220;
        --muted-text: #6b7280;

        --border: #e5e7eb;
      }

      body {
        margin: 0;
        background: var(--bg);
        color: var(--text);
        font-family: Inter, system-ui, sans-serif;
      }

      /* ================= Sidebar ================= */

      aside {
        position: fixed;
        top: 0;
        left: 0;
        height: 100vh;
        width: var(--sidebar-width);
        background: var(--surface);
        border-right: 1px solid var(--border);
        padding: 24px 16px;
        display: flex;
        flex-direction: column;
        gap: 24px;
      }

      .brand {
        font-size: 15px;
        font-weight: 600;
      }

      nav ul {
        list-style: none;
        padding: 0;
        margin: 0;
        display: flex;
        flex-direction: column;
        gap: 6px;
      }

      nav a {
        padding: 10px 12px;
        border-radius: 8px;
        text-decoration: none;
        color: var(--text);
        font-size: 14px;
      }

      nav a:hover {
        background: var(--accent-soft);
        color: var(--accent);
      }

      .sidebar {
        display: flex;
        flex-direction: column;
      }

      .sidebar nav {
        flex: 1;
      }

      .sidebar-footer {
        margin-top: auto;
        margin-bottom: 2.5rem;

        display: flex;
        align-items: center;
        justify-content: space-between;

        font-size: 12px;
        color: var(--muted-text);
      }

      .theme-toggle {
        display: flex;
        align-items: center;
      }

      .toggle-track {
        box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.05);
      }

      /* ================= Main ================= */

      main {
        margin-left: var(--sidebar-width);
        padding: 48px 40px;
      }

      .container {
        max-width: 1100px;
        margin: 0 auto;
      }

      article {
        background: var(--surface);
        border: 1px solid var(--border);
        border-radius: 16px;
        padding: 32px;
      }

      /* Markdown basics */
      h1,
      h2,
      h3 {
        letter-spacing: -0.02em;
      }

      table {
        width: 100%;
        border-collapse: collapse;
        margin: 24px 0;
      }

      th,
      td {
        padding: 12px;
        border-bottom: 1px solid var(--border);
      }

      tr:hover td {
        background: var(--accent-soft);
      }

      .theme-toggle {
        display: flex;
        justify-content: center;
      }

      .theme-toggle input {
        opacity: 0;
        position: absolute;
      }

      .toggle-track {
        width: 55px;
        height: 25px;
        background: #1b73ed;
        border-radius: 999px;
        padding: 4px;
        cursor: pointer;
        transition: background 0.4s ease;
        border: 1px solid var(--border);
      }

      .toggle-thumb {
        width: 24px;
        height: 24px;
        background: #87b0ea;
        border-radius: 50%;
        display: grid;
        place-items: center;
        transition:
          transform 0.4s ease,
          box-shadow 0.4s ease;
        font-size: 14px;
      }

      .toggle-thumb::before {
        content: "‚òÄÔ∏è";
        transition:
          opacity 0.3s ease,
          transform 0.3s ease;
      }

      /* Light mode */
      .theme-toggle input:checked + .toggle-track {
        background: #063356;
      }

      .theme-toggle input:checked + .toggle-track .toggle-thumb {
        transform: translateX(32px);
        background: #012d56;
        box-shadow: none;
      }

      .theme-toggle input:checked + .toggle-track .toggle-thumb::before {
        content: "üåô";
      }
    </style>
  </head>

  <body>
    <aside>
      <div class="brand">My Learning</div>

      <nav>
        <ul>
          <li><a href={href("")}>Tracker</a></li>
          <li><a href={href("goals")}>Goals</a></li>
          <li><a href={href("bucket-list")}>Bucket List</a></li>
        </ul>
      </nav>

      <div class="sidebar-footer">
        <span>¬© 2026</span>
        <div class="theme-toggle">
          <input type="checkbox" id="theme-toggle" />
          <label for="theme-toggle" class="toggle-track">
            <span class="toggle-thumb"></span>
          </label>
        </div>
      </div>
    </aside>

    <main>
      <div class="container">
        <article>
          <slot />
        </article>
      </div>
    </main>

    <script>
      const toggle = document.getElementById("theme-toggle");
      const html = document.documentElement;

      const savedTheme = localStorage.getItem("theme") || "dark";

      // Estado inicial
      if (savedTheme === "light") {
        html.classList.add("light");
        toggle.checked = true;
      } else {
        html.classList.remove("light");
        toggle.checked = false;
      }

      // Alternar tema
      toggle.addEventListener("change", () => {
        if (toggle.checked) {
          html.classList.add("light");
          localStorage.setItem("theme", "light");
        } else {
          html.classList.remove("light");
          localStorage.setItem("theme", "dark");
        }
      });
    </script>
  </body>
</html>
